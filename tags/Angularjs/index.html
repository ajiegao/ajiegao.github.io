<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Tag: Angularjs | ajiegao</title>
  <meta name="viewport" content="width=device-width">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="ajiegao">
<meta property="og:url" content="http://ajiegao.com/tags/Angularjs/">
<meta property="og:site_name" content="ajiegao">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ajiegao">
<meta name="twitter:description">
<meta name="twitter:creator" content="@[object Object]">

  
    <link rel="alternative" href="/atom.xml" title="ajiegao" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">ajiegao</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://ajiegao.com"></form>
	</div>
</header>
    <div id="main">
      
  
    <article id="post-Angularjs-form-1" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/11/27/Angularjs-form-1/" class="article-date">
  <time datetime="2014-11-27T12:16:04.000Z" itemprop="datePublished">Nov 27 2014</time>
</a>
		</span>
		<span class="meta-elements author">ajie</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/11/27/Angularjs-form-1/">Angularjs form实践(1)</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h2 id="ng表单验证">ng表单验证</h2>
<p>form是ng中<code>FormController</code>的一个实例。<br>同理，表单元素也是<code>ngModalController</code>的实例。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">form</span>&gt;</span><span class="tag">&lt;/<span class="title">form</span>&gt;</span></div></pre></td></tr></table></figure>

<p>表单和元素都需要一个<code>name</code>属性去做验证。<br><code>novalidate</code>属性可以阻止表单自身的验证动作。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">form</span> <span class="attribute">name</span>=<span class="value">"loginForm"</span> <span class="attribute">novalidate</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">type</span>=<span class="value">"text"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">form</span>&gt;</span></div></pre></td></tr></table></figure>

<h2 id="表单验证状态">表单验证状态</h2>
<p>ng默认提供以下状态</p>
<ul>
<li><code>$valid</code>:   验证通过</li>
<li><code>$invalid</code>: 验证未通过</li>
<li><code>$pristine</code>:还没有交互</li>
<li><code>$dirty</code>:   已经有交互</li>
<li><code>$error</code>:   错误状态</li>
</ul>
<p>获取方法 <code>&lt;form name&gt;.&lt;angular property&gt;</code> 或 <code>&lt;form name&gt;.&lt;input name&gt;.&lt;angular property&gt;</code>。 例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">loginForm.$valid</div><div class="line">loginForm.username.$valid</div></pre></td></tr></table></figure>

<p>除了<code>$error</code>其他四个状态都是Boolean。</p>
<h2 id="表单元素属性验证">表单元素属性验证</h2>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">required</span> <span class="attribute">ng-model</span>=<span class="value">"user.username"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">ng-show</span>=<span class="value">"loginForm.username.$error.required"</span>&gt;</span>Required<span class="tag">&lt;/<span class="title">span</span>&gt;</span></div></pre></td></tr></table></figure>

<p>以上例子<code>input</code>有一个<code>required</code>属性，<code>span</code>标签用来验证状态展示，<br>在<code>required</code>验证未通过时显示。</p>
<p>需要注意 <strong>所有需要验证的元素都必须用ngModel</strong></p>
<p>ng自带的一些属性验证和相对应的验证状态有</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ng-required=<span class="string">"..."</span>	    ngModel.$error.required</div><div class="line">ng-minlength=<span class="string">"number"</span>   ngModel.$error.minlength</div><div class="line">ng-maxlength=<span class="string">"number"</span>   ngModel.$error.maxlength</div><div class="line">ng-min=<span class="string">"number"</span>         ngModel.$error.min</div><div class="line">ng-max=<span class="string">"number"</span>         ngModel.$error.max</div><div class="line">ng-pattern=<span class="string">"pattern"</span>	ngModel.$error.pattern</div></pre></td></tr></table></figure>

<p><code>$error</code>状态可以访问ng定义的属性对应的状态</p>
<p>这样就能完善上面的username验证</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">input</span></span></div><div class="line">    <span class="attribute">name</span>=<span class="value">"username"</span></div><div class="line">    <span class="attribute">type</span>=<span class="value">"text"</span></div><div class="line">    <span class="attribute">placeholder</span>=<span class="value">"Username"</span></div><div class="line">    <span class="attribute">ng-model</span>=<span class="value">"user.username"</span></div><div class="line">    <span class="attribute">minlength</span>=<span class="value">"5"</span></div><div class="line">    <span class="attribute">maxlength</span>=<span class="value">"100"</span></div><div class="line">    <span class="attribute">required</span> /&gt;</div><div class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">ng-show</span>=<span class="value">"loginForm.username.$error.required"</span>&gt;</span>Required<span class="tag">&lt;/<span class="title">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">ng-show</span>=<span class="value">"loginForm.username.$error.minlength"</span>&gt;</span>too little<span class="tag">&lt;/<span class="title">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">ng-show</span>=<span class="value">"loginForm.username.$error.maxlength"</span>&gt;</span>too much<span class="tag">&lt;/<span class="title">span</span>&gt;</span></div></pre></td></tr></table></figure>

<p>required, minlength, maxlength, min, max, pattern很好理解，和html5提供的元素属性类似<br>，pattern属性是用于正则验证，值就是正则的pattern， 如手机号码验证</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">input</span></span></div><div class="line">    <span class="attribute">type</span>=<span class="value">"text"</span></div><div class="line">    <span class="attribute">placeholder</span>=<span class="value">"phone"</span></div><div class="line">    <span class="attribute">name</span>=<span class="value">"mobile"</span></div><div class="line">    <span class="attribute">ng-model</span>=<span class="value">"user.phone"</span></div><div class="line">    <span class="attribute">ng-pattern</span>=<span class="value">"/1[3|5|7|8|][0-9]{9}/"</span></div><div class="line">    <span class="attribute">required</span> /&gt;</div><div class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">ng-show</span>=<span class="value">"loginForm.username.$error.pattern"</span>&gt;</span>Wrong phone number <span class="tag">&lt;/<span class="title">span</span>&gt;</span></div></pre></td></tr></table></figure>

<h2 id="表单元素类型验证">表单元素类型验证</h2>
<p>ng自定义类型和所对应状态有</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">type=<span class="string">"email"</span>	ngModel.$error.email</div><div class="line">type=<span class="string">"url"</span>	    ngModel.$error.url</div><div class="line">type=<span class="string">"number"</span>	ngModel.$error.number</div><div class="line">type=<span class="string">"date"</span>	    ngModel.$error.date</div><div class="line">type=<span class="string">"time"</span>	    ngModel.$error.time</div><div class="line">type=<span class="string">"datetime"</span>	ngModel.$error.datetimelocal</div><div class="line">type=<span class="string">"week"</span>	    ngModel.$error.week</div><div class="line">type=<span class="string">"month"</span>	ngModel.$error.month</div></pre></td></tr></table></figure>

<p>同样从<code>$error</code>状态集合中可以访问</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">input</span></span></div><div class="line">    <span class="attribute">name</span>=<span class="value">"email"</span></div><div class="line">    <span class="attribute">type</span>=<span class="value">"email"</span></div><div class="line">    <span class="attribute">placeholder</span>=<span class="value">"Email"</span></div><div class="line">    <span class="attribute">ng-model</span>=<span class="value">"user.email"</span></div><div class="line">    <span class="attribute">required</span> /&gt;</div><div class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">ng-show</span>=<span class="value">"loginForm.email.$error.required"</span>&gt;</span>Need email<span class="tag">&lt;/<span class="title">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">span</span> <span class="attribute">ng-show</span>=<span class="value">"loginForm.email.$error.email"</span>&gt;</span>Wrong email<span class="tag">&lt;/<span class="title">span</span>&gt;</span></div></pre></td></tr></table></figure>

<h2 id="使用css_和_css_classes">使用css 和 css classes</h2>
<p>可以设置和所对应状态同名的class</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class">.ng-valid</span> <span class="rules">{<span class="rule">}</span></span></div><div class="line"><span class="class">.ng-invalid</span> <span class="rules">{<span class="rule">}</span></span></div><div class="line"><span class="class">.ng-pristine</span> <span class="rules">{<span class="rule">}</span></span></div><div class="line"><span class="class">.ng-dirty</span> <span class="rules">{<span class="rule">}</span></span></div></pre></td></tr></table></figure>

<p>如官方文档的demo中有如下设置</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">input</span><span class="class">.ng-invalid</span><span class="class">.ng-dirty</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#FA787E</span></span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="tag">input</span><span class="class">.ng-valid</span><span class="class">.ng-dirty</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#78FA89</span></span></span>;</div><div class="line"><span class="rule">}</span></div></pre></td></tr></table></figure>

<p>以状态改变class</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-class</span>=<span class="value">"{'error': loginForm.username.$invalid, 'success':loginForm.username.$valid}"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">placeholder</span>=<span class="value">"Username"</span> <span class="attribute">required</span> <span class="attribute">ng-model</span>=<span class="value">"user.username"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">span</span> <span class="attribute">ng-show</span>=<span class="value">"loginForm.username.$error.required"</span>&gt;</span>Required<span class="tag">&lt;/<span class="title">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></td></tr></table></figure>

<h2 id="禁用提交按钮">禁用提交按钮</h2>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">type</span>=<span class="value">"submit"</span> <span class="attribute">ng-disabled</span>=<span class="value">"loginForm.$invalid"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span></div></pre></td></tr></table></figure>

<!-- 自定义触发条件
ng-model-options="{ updateOn: 'default blur' }"

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">app.controller(<span class="string">'loginController'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span><span class="params">($scope)</span> </span>{</div><div class="line">    $scope.submitForm = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">        <span class="keyword">if</span> ($scope.loginForm.$valid) {</div><div class="line">            <span class="comment">//to login</span></div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            $scope.loginForm.submitted = <span class="literal">true</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}]);</div></pre></td></tr></table></figure>

 -->


<h2 id="参考">参考</h2>
<ul>
<li><p><a href="https://docs.angularjs.org/guide/forms" target="_blank" rel="external">docs.angularjs</a></p>
</li>
<li><p><a href="http://www.yearofmoo.com/2014/09/taming-forms-in-angularjs-1-3.html" target="_blank" rel="external">Taming Forms in AngularJS 1.3</a></p>
</li>
<li><p><a href="http://www.ng-newsletter.com/posts/validations.html" target="_blank" rel="external">Form validation with AngularJS</a></p>
</li>
</ul>
<!-- 自定义验证

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'validationExample'</span>, []);</div><div class="line"></div><div class="line">app.directive(<span class="string">'ensureUnique'</span>, [<span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span><span class="params">($http)</span> </span>{</div><div class="line">  <span class="keyword">return</span> {</div><div class="line">    <span class="built_in">require</span>: <span class="string">'ngModel'</span>,</div><div class="line">    link: <span class="function"><span class="keyword">function</span><span class="params">(scope, ele, attrs, c)</span> </span>{</div><div class="line">      scope.$watch(attrs.ngModel, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">        $http({</div><div class="line">          method: <span class="string">'POST'</span>,</div><div class="line">          url: <span class="string">'/api/check/'</span> + attrs.ensureUnique,</div><div class="line">          data: {<span class="string">'field'</span>: attrs.ensureUnique}</div><div class="line">        }).success(<span class="function"><span class="keyword">function</span><span class="params">(data, status, headers, cfg)</span> </span>{</div><div class="line">          c.$setValidity(<span class="string">'unique'</span>, data.isUnique);</div><div class="line">        }).error(<span class="function"><span class="keyword">function</span><span class="params">(data, status, headers, cfg)</span> </span>{</div><div class="line">          c.$setValidity(<span class="string">'unique'</span>, <span class="literal">false</span>);</div><div class="line">        });</div><div class="line">      });</div><div class="line">    }</div><div class="line">  }</div><div class="line">}]);</div></pre></td></tr></table></figure>

 -->

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Angularjs/">Angularjs</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
  

    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:ajiegao.com">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">ajiegao</a>
	</h1>
	<span class="copyright">
		&copy; 2014 ajie<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    

<script src="/js/jquery-2.1.1.min.js"></script>



<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>